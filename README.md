# TXT 转 Excel 批量转换器

## 功能简介
该程序用于将文件夹中的 `.txt` 数据文件批量转换为 Excel `.xlsx` 文件，并具备以下特性：

- **列选择**：可指定要提取的列（从 1 开始计数）。  
- **编码自动识别**：支持 UTF-8、GBK、ANSI、UTF-16 编码。  
- **分隔符自动检测**：支持逗号、制表符、空格分隔。  
- **数据格式处理**：
  - 第一行保持原始文本格式  
  - 第一列保持文本格式  
  - 其他列转换为数字  
- **批量处理**：支持整个文件夹 TXT 文件批量转换  
- **进度提示**：显示处理进度条和状态信息  

## 环境要求

- Python 3.7+
- 依赖库：
```bash
pip install pandas tqdm openpyxl
```

## 使用方法

1. **准备 TXT 文件**  
   将 TXT 文件放在同一个文件夹中。  

2. **修改脚本路径**  
   打开 `txt2excel.py`，修改：
```python
folder_path = r"example_txt"  # 修改为你的 TXT 文件夹路径
```

3. **运行脚本**  
```bash
python txt2excel.py
```

4. **输入要提取的列号**  
程序会提示：
```
请输入要提取的列号（例如: 1,3,5 表示第1、3、5列）:
```
输入列号，例如：
```
1,3,5
```

5. **查看输出**  
生成的 Excel 文件与 TXT 文件同名，存放在同一目录下，扩展名为 `.xlsx`。

## 示例

**TXT 文件内容（空格分隔）**：
```
ID  A  B  C  D
001 10 20 30 40
002 15 25 35 45
```

**输入列号**：`1,3,4`  

**生成 Excel 内容**：

| ID  | B  | C  |
|-----|----|----|
| ID  | B  | C  | ← 第一行保持文本  
| 001 | 20 | 30 |
| 002 | 25 | 35 |

## 注意事项

- 列号从 **1 开始计数**，不能超过 TXT 文件的总列数  
- 非数字列转换失败会显示空白（NaN）  
- 文件夹路径建议使用绝对路径并加 `r"..."` 前缀  
- 大文件处理可能需要一些时间，请耐心等待  
